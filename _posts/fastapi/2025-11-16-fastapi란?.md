---
title: FastAPI í†ºì•„ë³´ê¸°
date: 2025-11-16 13:00:00 +09:00
categories: [python, fastapi]
tags:
  [
    python,
    fastapi,
  ]
---

FastAPI ê³µì‹ ë¬¸ì—ì„œëŠ” FastAPIë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.

> FastAPI is a modern, fast (high-performance), web framework for building APIs with Python based on standard Python type hints.

ì¦‰, FastAPIëŠ” í‘œì¤€ Python íƒ€ì… íŒíŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ APIë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•œ í˜„ëŒ€ì ì´ê³  ë¹ ë¥¸ ê³ ì„±ëŠ¥ ì›¹ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.

FastAPIê°€ ì–´ë–»ê²Œ êµ¬ì„±ë˜ì–´ ìˆê³  ì–´ë–¤ ì¥ì ì´ ìˆëŠ”ì§€ í•˜ë‚˜ì”© ê³µì‹ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

ë¶„ì„ ì¤‘ ë‚˜ì˜¤ëŠ” ëª¨ë“  ì½”ë“œëŠ” ì•„ë˜ í™˜ê²½ì„ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

##  ğŸ³ ë¶„ì„ í™˜ê²½
- fastAPI: 0.121.1
- python: 3.13
- pydantic: 2.12.4

---

## âœ… FastAPIì˜ êµ¬ì„±
FastAPIëŠ” í¬ê²Œ ë‘ ê°€ì§€ í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ìœ„ì—ì„œ ë™ì‘í•©ë‹ˆë‹¤.

1. **Starlette**: ASGI ê¸°ë°˜ì˜ ë¹„ë™ê¸° ì›¹ í”„ë ˆì„ì›Œí¬ë¡œ, FastAPIì˜ ì›¹ ì„œë²„ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. ë¼ìš°íŒ…, ë¯¸ë“¤ì›¨ì–´, Request/Response ì²˜ë¦¬ ë“± ì›¹ í”„ë ˆì„ì›Œí¬ì˜ ê¸°ë³¸ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
2. **Pydantic**: íƒ€ì… íŒíŠ¸ ê¸°ë°˜ì˜ ë°ì´í„° ê²€ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, ìš”ì²­ ë° ì‘ë‹µ ë°ì´í„°ì˜ ìë™ ê²€ì¦ê³¼ ì§ë ¬í™”ë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤.

FastAPIëŠ” ì´ ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œì í¸ì˜ì„±ì„ ëŒ€í­ ê°•í™”í•œ í”„ë ˆì„ì›Œí¬ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € Starletteì˜ ì—­í• ë¶€í„° ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

### ğŸ“Œ Starlette
StarletteëŠ” FastAPIì˜ ê¸°ë°˜ì´ ë˜ëŠ” ASGI ì›¹ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. FastAPIëŠ” ì‹¤ì œë¡œ Starletteë¥¼ ìƒì†ë°›ì•„ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì½”ë“œë¥¼ í†µí•´ ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

```python
from fastapi import FastAPI

app.get("/root")
async def root():
    return {"message": "Hello World"}

```

ìœ„ ì½”ë“œì—ì„œëŠ” `FastAPI` ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  `@app.get("/root")` ë°ì½”ë ˆì´í„°ë¡œ `/root` ê²½ë¡œì— ëŒ€í•œ GET ìš”ì²­ í•¸ë“¤ëŸ¬ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.

FastAPI í´ë˜ìŠ¤ì˜ ë‚´ë¶€ êµ¬í˜„ì„ ë“¤ì—¬ë‹¤ë³´ë©´ (`fastapi/applications.py`), Starletteë¥¼ importí•˜ê³  ìƒì†ë°›ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

FastAPI Class ë“¤ì–´ê°€ë©´ `application.py` íŒŒì¼ì´ ë‚˜ì˜¤ëŠ”ë° ê±°ê¸°ì„œ `Starletteë¥¼ import` í•˜ê³  ìˆìŠµë‹ˆë‹¤.

```python
from starlette.applications import Starlette

class FastAPI(Starlette):
    def __init__(self, ...):
```

ì´ì²˜ëŸ¼ FastAPIëŠ” Starletteì˜ í•µì‹¬ ê¸°ëŠ¥ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ì„œ, ê·¸ ìœ„ì— ì¶”ê°€ì ì¸ í¸ì˜ ê¸°ëŠ¥ë“¤ì„ ì˜¬ë¦° êµ¬ì¡°ì…ë‹ˆë‹¤.

<br>

#### 1ï¸âƒ£ ë¼ìš°íŒ… (Routing)

Starletteì˜ ê°€ì¥ í•µì‹¬ì ì¸ ê¸°ëŠ¥ì€ ë¼ìš°íŒ…ì…ë‹ˆë‹¤. ë¼ìš°íŒ…ì´ë€ í´ë¼ì´ì–¸íŠ¸ì˜ HTTP ìš”ì²­ì„ ì ì ˆí•œ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ë¡œ ì—°ê²°í•´ì£¼ëŠ” ì‘ì—…ì„ ë§í•©ë‹ˆë‹¤.
`ex) Springì˜ Dispatcher Servlet ì—­í• `

`/starlette/routing.py` íŒŒì¼ì„ ì‚´í´ë³´ë©´ ë¼ìš°íŒ…ì˜ í•µì‹¬ í´ë˜ìŠ¤ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Router í´ë˜ìŠ¤**
```python
class Router:
    def __init__(
        self,
        routes: Sequence[BaseRoute] | None = None,
        redirect_slashes: bool = True,
        default: ASGIApp | None = None,
        on_startup: Sequence[Callable[[], Any]] | None = None,
        on_shutdown: Sequence[Callable[[], Any]] | None = None,
        lifespan: Lifespan[Any] | None = None,
        *,
        middleware: Sequence[Middleware] | None = None,
    ) -> None:
        self.routes = [] if routes is None else list(routes)
        self.redirect_slashes = redirect_slashes
        self.default = self.not_found if default is None else default
        # ...
```

`Router` í´ë˜ìŠ¤ëŠ” ì—¬ëŸ¬ ê°œì˜ `Route`ë¥¼ ê´€ë¦¬í•˜ëŠ” í•µì‹¬ í´ë˜ìŠ¤ì…ë‹ˆë‹¤. ì£¼ìš” íŒŒë¼ë¯¸í„°ë¥¼ ì‚´í´ë³´ë©´:

- `routes`: Route ê°ì²´ë“¤ì˜ ë¦¬ìŠ¤íŠ¸
- `redirect_slashes`: ìŠ¬ë˜ì‹œ(`/`) ë¦¬ë‹¤ì´ë ‰ì…˜ ì—¬ë¶€ (ì˜ˆ: `/users/` â†’ `/users`)
- `default`: ë§¤ì¹­ë˜ëŠ” ë¼ìš°íŠ¸ê°€ ì—†ì„ ë•Œ ì‹¤í–‰ë  ê¸°ë³¸ í•¸ë“¤ëŸ¬
- `on_startup`, `on_shutdown`: ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘/ì¢…ë£Œ ì‹œ ì‹¤í–‰ë  í•¨ìˆ˜ë“¤ (deprecated)
- `lifespan`: ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬ë¥¼ ìœ„í•œ ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì € (ìµœì‹  ë°©ì‹)
- `middleware`: ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬ì— ì ìš©ë  ë¯¸ë“¤ì›¨ì–´ ë¦¬ìŠ¤íŠ¸

RouterëŠ” ë“±ë¡ëœ ëª¨ë“  ë¼ìš°íŠ¸ë¥¼ ìˆœíšŒí•˜ë©° ìš”ì²­ê³¼ ë§¤ì¹­ë˜ëŠ” ë¼ìš°íŠ¸ë¥¼ ì°¾ì•„ í•´ë‹¹ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.

FastAPIì—ì„œ `@app.get()`, `@app.post()` ê°™ì€ ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ë©´, ë‚´ë¶€ì ìœ¼ë¡œëŠ” ì´ `Route` ê°ì²´ê°€ ìƒì„±ë˜ì–´ `Router`ì— ë“±ë¡ë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´:
```python
@app.get("/users/{user_id}")
async def get_user(user_id: int):
    return {"user_id": user_id}
```

ì´ ì½”ë“œëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•©ë‹ˆë‹¤:
```python
# ë‚´ë¶€ ë™ì‘ (simplified)
route = Route(
    path="/users/{user_id}",
    endpoint=get_user,
    methods=["GET"]
)
app.router.routes.append(route)
```

ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´:
1. Routerê°€ ë“±ë¡ëœ ëª¨ë“  Routeë¥¼ ìˆœíšŒ
2. ê° Routeì˜ `matches()` ë©”ì„œë“œë¡œ ê²½ë¡œ ë§¤ì¹­ í™•ì¸
3. ë§¤ì¹­ë˜ëŠ” Routeë¥¼ ì°¾ìœ¼ë©´ í•´ë‹¹ endpoint í•¨ìˆ˜ ì‹¤í–‰
4. path parameterëŠ” ìë™ìœ¼ë¡œ ì¶”ì¶œë˜ì–´ í•¨ìˆ˜ ì¸ìë¡œ ì „ë‹¬
5. ë§¤ì¹­ë˜ëŠ” Routeê°€ ì—†ìœ¼ë©´ `default` í•¸ë“¤ëŸ¬ ì‹¤í–‰ (ë³´í†µ 404 ì—ëŸ¬)

<br>

#### 2ï¸âƒ£ ë¯¸ë“¤ì›¨ì–´ (Middleware)

ë¯¸ë“¤ì›¨ì–´ëŠ” ìš”ì²­ì´ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì— ë„ë‹¬í•˜ê¸° ì „ê³¼ ì‘ë‹µì´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬ë˜ê¸° ì „ì— ì‹¤í–‰ë˜ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤. ë¡œê¹…, ì¸ì¦, CORS ì²˜ë¦¬, ì••ì¶• ë“± ê³µí†µì ì¸ ì²˜ë¦¬ ë¡œì§ì„ ë¯¸ë“¤ì›¨ì–´ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`ex) Springì˜ Filter ë˜ëŠ” interceptor ì—­í• ` 


StarletteëŠ” `starlette/middleware` íŒ¨í‚¤ì§€ì—ì„œ ë‹¤ì–‘í•œ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

**ë¯¸ë“¤ì›¨ì–´ì˜ ë™ì‘ ë°©ì‹**
```python
from starlette.middleware.base import BaseHTTPMiddleware

class CustomMiddleware(BaseHTTPMiddleware):
    async def dispatch(self, request, call_next):
        # ìš”ì²­ ì²˜ë¦¬ ì „ ë¡œì§
        print(f"Request: {request.url}")
        
        # ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ ë˜ëŠ” ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ í˜¸ì¶œ
        response = await call_next(request)
        
        # ì‘ë‹µ ì²˜ë¦¬ í›„ ë¡œì§
        print(f"Response status: {response.status_code}")
        
        return response
```

ë¯¸ë“¤ì›¨ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìˆœì„œë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤:
```
Client Request
    â†“
Middleware 1 (before)
    â†“
Middleware 2 (before)
    â†“
Route Handler
    â†“
Middleware 2 (after)
    â†“
Middleware 1 (after)
    â†“
Client Response
```

**Middleware í´ë˜ìŠ¤**
```python
# starlette/middleware/__init__.py
@dataclass
class Middleware:
  def __init__(self, cls: _MiddlewareFactory[P], *args: P.args, **kwargs: P.kwargs) -> None:
    self.cls = cls
    self.args = args
    self.kwargs = kwargs
```

`Middleware` í´ë˜ìŠ¤ëŠ” ë¯¸ë“¤ì›¨ì–´ì˜ ë©”íƒ€ë°ì´í„°ë¥¼ ë‹´ëŠ” ë°ì´í„° í´ë˜ìŠ¤ì…ë‹ˆë‹¤:

- `cls`: ì‹¤ì œ ë¯¸ë“¤ì›¨ì–´ í´ë˜ìŠ¤
- `args`: ë¯¸ë“¤ì›¨ì–´ ìƒì„±ìì— ì „ë‹¬í•  ìœ„ì¹˜ ì¸ì
- `kwargs`: ë¯¸ë“¤ì›¨ì–´ ìƒì„±ìì— ì „ë‹¬í•  í‚¤ì›Œë“œ ì¸ì

FastAPIì—ì„œ ë¯¸ë“¤ì›¨ì–´ë¥¼ ë“±ë¡í•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ ë‘ ê°€ì§€ì…ë‹ˆë‹¤:

**ë°©ë²• 1: ë°ì½”ë ˆì´í„° ì‚¬ìš©**
```python
from fastapi import FastAPI, Request

app = FastAPI()

@app.middleware("http")
async def add_process_time_header(request: Request, call_next):
    import time
    start_time = time.time()
    
    response = await call_next(request)
    
    process_time = time.time() - start_time
    response.headers["X-Process-Time"] = str(process_time)
    return response
```

**ë°©ë²• 2: add_middleware ë©”ì„œë“œ ì‚¬ìš©**
```python
from fastapi import FastAPI
from starlette.middleware.cors import CORSMiddleware
from starlette.middleware.gzip import GZipMiddleware

app = FastAPI()

# CORS ë¯¸ë“¤ì›¨ì–´
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# GZip ì••ì¶• ë¯¸ë“¤ì›¨ì–´
app.add_middleware(GZipMiddleware, minimum_size=1000)
```

**Starletteì˜ ì£¼ìš” ë‚´ì¥ ë¯¸ë“¤ì›¨ì–´**

1. **CORSMiddleware**: Cross-Origin Resource Sharing ì²˜ë¦¬
2. **GZipMiddleware**: ì‘ë‹µ ì••ì¶•
3. **TrustedHostMiddleware**: í—ˆìš©ëœ í˜¸ìŠ¤íŠ¸ë§Œ ì ‘ê·¼ ê°€ëŠ¥
4. **HTTPSRedirectMiddleware**: HTTPë¥¼ HTTPSë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
5. **SessionMiddleware**: ì„¸ì…˜ ê´€ë¦¬

**ë¯¸ë“¤ì›¨ì–´ ìŠ¤íƒ êµ¬ì„±**

Router í´ë˜ìŠ¤ì—ì„œ ë¯¸ë“¤ì›¨ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë©ë‹ˆë‹¤:
```python
class Router:
    def __init__(
        self,
        routes: Sequence[BaseRoute] | None = None,
        *,
        middleware: Sequence[Middleware] | None = None,
    ) -> None:
        self.routes = [] if routes is None else list(routes)
        self.middleware = [] if middleware is None else list(middleware)
```

ë‚´ë¶€ì ìœ¼ë¡œ ë¯¸ë“¤ì›¨ì–´ë“¤ì€ ìŠ¤íƒ êµ¬ì¡°ë¡œ ìŒ“ì´ë©°, ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì—­ìˆœìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤:
```python
# ë¯¸ë“¤ì›¨ì–´ ë“±ë¡ ìˆœì„œ
app.add_middleware(Middleware1)  # ì²« ë²ˆì§¸
app.add_middleware(Middleware2)  # ë‘ ë²ˆì§¸
app.add_middleware(Middleware3)  # ì„¸ ë²ˆì§¸

# ì‹¤í–‰ ìˆœì„œ
# Request: Middleware3 â†’ Middleware2 â†’ Middleware1 â†’ Handler
# Response: Handler â†’ Middleware1 â†’ Middleware2 â†’ Middleware3
```

ì‹¤ì œ ì˜ˆì‹œë¡œ ë³´ë©´:
```python
from fastapi import FastAPI, Request
from starlette.middleware.cors import CORSMiddleware

app = FastAPI()

# 1. CORS ë¯¸ë“¤ì›¨ì–´ ë“±ë¡
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000"],
)

# 2. ì»¤ìŠ¤í…€ ë¡œê¹… ë¯¸ë“¤ì›¨ì–´
@app.middleware("http")
async def log_requests(request: Request, call_next):
    print(f"[Before] {request.method} {request.url}")
    response = await call_next(request)
    print(f"[After] Status: {response.status_code}")
    return response

@app.get("/test")
async def test():
    return {"message": "test"}
```

ìœ„ ì½”ë“œì—ì„œ `/test` ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´:

1. ë¡œê¹… ë¯¸ë“¤ì›¨ì–´ ì‹¤í–‰ (before) - `[Before] GET /test`
2. CORS ë¯¸ë“¤ì›¨ì–´ ì‹¤í–‰
3. ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ ì‹¤í–‰ - `{"message": "test"}`
4. CORS ë¯¸ë“¤ì›¨ì–´ ì™„ë£Œ (CORS í—¤ë” ì¶”ê°€)
5. ë¡œê¹… ë¯¸ë“¤ì›¨ì–´ ì™„ë£Œ (after) - `[After] Status: 200`

ìœ„ì²˜ëŸ¼ ì²˜ë¦¬ë˜ì–´ ìˆœì„œë¥¼ ì—¼ë‘ì— ë‘ê³  ë¯¸ë“¤ì›¨ì–´ë¥¼ ì„¤ê³„í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

<br>

#### 3ï¸âƒ£ Request/Response ì²˜ë¦¬

StarletteëŠ” HTTP ìš”ì²­ê³¼ ì‘ë‹µì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ `Request`ì™€ ë‹¤ì–‘í•œ `Response` í´ë˜ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì™€ì˜ í†µì‹ ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
 `ex) Springì˜ HttpServletRequest, HttpServletResponse ì—­í• `
* Requestì™€ ResponseëŠ” ì œì™¸í• ê¹Œ í•˜ë‹¤ê°€ FastAPIì—ì„œ ì˜ì™¸ë¡œ ë‹¤ë£°ì¼ì´ ìˆì–´ì„œ í¬í•¨ì‹œì¼°ìŠµë‹ˆë‹¤.


**Request í´ë˜ìŠ¤**
```python
# starlette/requests.py
class Request(HTTPConnection):
  _form: FormData | None

  def __init__(self, scope: Scope, receive: Receive = empty_receive, send: Send = empty_send):
    super().__init__(scope)
    assert scope["type"] == "http"
    self._receive = receive
    self._send = send
    self._stream_consumed = False
    self._is_disconnected = False
    self._form = None
```

`Request` ê°ì²´ëŠ” í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ HTTP ìš”ì²­ì˜ ëª¨ë“  ì •ë³´ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ì£¼ìš” ë©”ì„œë“œì™€ í”„ë¡œí¼í‹°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

**ìš”ì²­ ë°ì´í„° íŒŒì‹±**
```python
# JSON ë°ì´í„° íŒŒì‹±
async def json(self) -> Any:
    if not hasattr(self, "_json"):
        body = await self.body()
        self._json = json_loads(body)
    return self._json

# Raw body ì½ê¸°
async def body(self) -> bytes:
    if not hasattr(self, "_body"):
        chunks: list[bytes] = []
        async for chunk in self.stream():
            chunks.append(chunk)
        self._body = b"".join(chunks)
    return self._body
```

**ìš”ì²­ ì •ë³´ ì ‘ê·¼**
```python
@property
def query_params(self) -> QueryParams:
    # URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° (ì˜ˆ: ?page=1&limit=10)
    if not hasattr(self, "_query_params"):
        self._query_params = QueryParams(self._scope["query_string"])
    return self._query_params

@property
def path_params(self) -> dict[str, Any]:
    # Path íŒŒë¼ë¯¸í„° (ì˜ˆ: /users/{user_id})
    return self._scope.get("path_params", {})

@property
def headers(self) -> Headers:
    # HTTP í—¤ë”
    if not hasattr(self, "_headers"):
        self._headers = Headers(scope=self._scope)
    return self._headers

@property
def cookies(self) -> dict[str, str]:
    if not hasattr(self, "_cookies"):
        cookies: dict[str, str] = {}
        cookie_header = self.headers.get("cookie")
        if cookie_header:
            cookies = parse_cookie(cookie_header)
        self._cookies = cookies
    return self._cookies
```

ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ:
```python
from starlette.requests import Request
from starlette.responses import JSONResponse

async def handle_request(request: Request):
    # ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
    page = request.query_params.get("page", "1")
    
    # Path íŒŒë¼ë¯¸í„°
    user_id = request.path_params.get("user_id")
    
    # í—¤ë”
    auth_token = request.headers.get("Authorization")
    
    # JSON body
    data = await request.json()
    
    # ì¿ í‚¤
    session_id = request.cookies.get("session_id")
    
    return JSONResponse({
        "page": page,
        "user_id": user_id,
        "has_auth": auth_token is not None
    })
```

**Response í´ë˜ìŠ¤**

StarletteëŠ” ë‹¤ì–‘í•œ ìƒí™©ì— ë§ëŠ” ì—¬ëŸ¬ Response í´ë˜ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
```python
# starlette/responses.py

# 1. ê¸°ë³¸ Response
class Response:
  media_type = None
  charset = "utf-8"

  def __init__(
    self,
    content: Any = None,
    status_code: int = 200,
    headers: Mapping[str, str] | None = None,
    media_type: str | None = None,
    background: BackgroundTask | None = None,
  ) -> None:
    self.status_code = status_code
    if media_type is not None:
      self.media_type = media_type
    self.background = background
    self.body = self.render(content)
    self.init_headers(headers)

# 2. JSON ì‘ë‹µ
class JSONResponse(Response):
    media_type = "application/json"

    def __init__(
      self,
      content: Any,
      status_code: int = 200,
      headers: Mapping[str, str] | None = None,
      media_type: str | None = None,
      background: BackgroundTask | None = None,
    ) -> None:
      super().__init__(content, status_code, headers, media_type, background)
      
    def render(self, content: Any) -> bytes:
        return json_dumps(
            content,
            ensure_ascii=False,
            allow_nan=False,
            indent=None,
            separators=(",", ":"),
        ).encode("utf-8")

# 3. HTML ì‘ë‹µ
class HTMLResponse(Response):
    media_type = "text/html"

# 4. íŒŒì¼ ì‘ë‹µ
class FileResponse(Response):
    chunk_size = 64 * 1024  # 64KB
    
    def __init__(
        self,
      path: str | os.PathLike[str],
      status_code: int = 200,
      headers: Mapping[str, str] | None = None,
      media_type: str | None = None,
      background: BackgroundTask | None = None,
      filename: str | None = None,
      stat_result: os.stat_result | None = None,
      method: str | None = None,
      content_disposition_type: str = "attachment",
    ) -> None:
        # ...

# 6. ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‘ë‹µ
class RedirectResponse(Response):
    def __init__(
        self,
        url: str | URL,
        status_code: int = 307,
        headers: Mapping[str, str] | None = None,
      background: BackgroundTask | None = None,
    ) -> None:
        # ...
```

**Response ì‚¬ìš© ì˜ˆì‹œ**
```python
from starlette.responses import (
    JSONResponse, 
    HTMLResponse, 
    FileResponse,
    StreamingResponse,
    RedirectResponse
)

# JSON ì‘ë‹µ
@app.get("/api/users")
async def get_users():
    return JSONResponse({"users": [{"id": 1, "name": "John"}]})

# HTML ì‘ë‹µ
@app.get("/")
async def home():
    html_content = "<html><body><h1>Hello World</h1></body></html>"
    return HTMLResponse(content=html_content)

# íŒŒì¼ ë‹¤ìš´ë¡œë“œ
@app.get("/download")
async def download_file():
    return FileResponse(
        path="files/document.pdf",
        filename="download.pdf",
        media_type="application/pdf"
    )


# ë¦¬ë‹¤ì´ë ‰íŠ¸
@app.get("/old-url")
async def redirect():
    return RedirectResponse(url="/new-url")
```

**FastAPIì—ì„œì˜ í™œìš©**

FastAPIëŠ” Starletteì˜ Request/Responseë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ì„œ, ì¶”ê°€ì ì¸ í¸ì˜ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:
```python
from fastapi import FastAPI, Request
from starlette.responses import JSONResponse

app = FastAPI()

# Starlette Request ì§ì ‘ ì‚¬ìš© ê°€ëŠ¥
@app.get("/custom")
async def custom_handler(request: Request):
    # Starlette Request ê°ì²´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
    user_agent = request.headers.get("user-agent")
    client_host = request.client.host
    
    return JSONResponse({
        "user_agent": user_agent,
        "client_ip": client_host
    })

# FastAPIëŠ” ìë™ìœ¼ë¡œ dictë¥¼ JSONResponseë¡œ ë³€í™˜
@app.get("/simple")
async def simple_handler():
    # ë‚´ë¶€ì ìœ¼ë¡œ JSONResponseë¡œ ë³€í™˜ë¨
    return {"message": "Hello"}
```

---
<br><br>

### ğŸ“Œ Pydantic

ì¶”í›„ ì‘ì„± ì˜ˆì •.... 






